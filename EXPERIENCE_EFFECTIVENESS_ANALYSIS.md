# ç»éªŒç³»ç»Ÿæ•ˆç”¨åˆ†ææŠ¥å‘Š

**æµ‹è¯•ç¯å¢ƒ**: CartPole-v1  
**æµ‹è¯•æ—¥æœŸ**: 2025-11-26  
**æ ¸å¿ƒé—®é¢˜**: ç»éªŒæœ‰ç”¨å—ï¼Ÿ

---

## ğŸ¯ ç›´æ¥å›ç­”ï¼š**ç»éªŒåè€Œæœ‰å®³**

åœ¨è¿™æ¬¡CartPoleæµ‹è¯•ä¸­ï¼Œç»éªŒç³»ç»Ÿä¸ä»…**æ²¡æœ‰å¸®åŠ©**ï¼Œåè€Œ**åŠ é€Ÿäº†å¤±è´¥**ã€‚

---

## ğŸ“Š æ•°æ®åˆ†æ

### ç»éªŒè´¨é‡ç»Ÿè®¡

| ç±»å‹ | æ•°é‡ | å æ¯” | æè¿° |
|------|------|------|------|
| âœ… æœ‰æ•ˆç»éªŒ | 1 | 20% | çŠ¶æ€æœ‰è¿›å±• |
| âš ï¸ æ— æ•ˆç»éªŒ | 3 | **60%** | åŸåœ°è¸æ­¥ |
| âŒ å¤±è´¥ç»éªŒ | 1 | 20% | å¯¼è‡´å€’ä¸‹ |

**å…³é”®é—®é¢˜**: **60%çš„ç»éªŒæ˜¯"åŸåœ°è¸æ­¥"**ï¼Œä½†LLMæ— æ³•è¯†åˆ«å…¶æ— æ•ˆæ€§ã€‚

---

## ğŸ” ç»éªŒæ£€ç´¢ä¸ä½¿ç”¨æƒ…å†µ

### æ£€ç´¢ç»Ÿè®¡
- **æ£€ç´¢æ¬¡æ•°**: 8æ¬¡ (Steps 5, 8, 9, 11, 14-17)
- **æ£€ç´¢ç»éªŒæ€»æ•°**: 17æ¡æ¬¡
- **å¹³å‡æ¯æ¬¡æ£€ç´¢**: 2.1æ¡ç»éªŒ

### å…³é”®äº‹ä»¶æ—¶é—´çº¿

```
Step 5:  é¦–æ¬¡æ£€ç´¢ â†’ æ£€ç´¢åˆ°1æ¡ç»éªŒ
         çŠ¶æ€: (3,3,1,-1)
         ç»éªŒæ˜¾ç¤º: action 1 â†’ çŠ¶æ€ä¸å˜
         LLMé€‰æ‹©: action 1 âš ï¸ è·Ÿéšäº†æ— æ•ˆç»éªŒ

Step 8-9: ç¬¬äºŒæ¬¡å¾ªç¯
          æ£€ç´¢åˆ°1-2æ¡ç»éªŒ
          éƒ½æ˜¾ç¤º "action 0 â†’ çŠ¶æ€ä¸å˜"
          LLMç»§ç»­æ‰§è¡Œ action 0 âš ï¸

Steps 14-17: è‡´å‘½å¾ªç¯ ğŸ’€
             çŠ¶æ€: (4,1,1,-1) ã€poleå·²å‘å·¦å€¾æ–œï¼Œå±é™©ï¼ã€‘
             æ£€ç´¢åˆ°1-4æ¡ç»éªŒ
             æ‰€æœ‰ç»éªŒæ˜¾ç¤º: action 1 â†’ çŠ¶æ€ä¸å˜
             LLMè¿ç»­5æ¬¡é€‰æ‹© action 1
             
Step 18: theta_bin: 1 â†’ 0 (å€’ä¸‹) ğŸ’¥
```

---

## âŒ ç»éªŒç³»ç»Ÿçš„3å¤§é—®é¢˜

### 1. **æ— æ•ˆç»éªŒå ä¸»å¯¼** (60%)

**é—®é¢˜**: çŠ¶æ€ç¦»æ•£åŒ–è¿‡ç²—ï¼Œå¯¼è‡´å¤§é‡"åŸåœ°è¸æ­¥"ç»éªŒ

**ç¤ºä¾‹**:
```json
{
  "st": {"x_bin": 4, "theta_bin": 2, "x_dot_sign": 1, "theta_dot_sign": -1},
  "action": 0,
  "st1": {"x_bin": 4, "theta_bin": 2, "x_dot_sign": 1, "theta_dot_sign": -1}
}
```

**çœŸå®æƒ…å†µ**: 
- è¿ç»­çŠ¶æ€å…¶å®åœ¨å˜åŒ–ï¼ˆå¦‚thetaä»0.05å˜åˆ°0.04ï¼‰
- ä½†ç¦»æ•£åŒ–åéƒ½è½åœ¨åŒä¸€ä¸ªbin (theta_bin=2)
- çœ‹èµ·æ¥"æ²¡æœ‰å˜åŒ–"

**åæœ**: LLMè¯¯ä»¥ä¸º"è¿™ä¸ªåŠ¨ä½œå®‰å…¨"ï¼Œé‡å¤æ‰§è¡Œ

---

### 2. **LLMæ— æ³•ç†è§£"å¾ªç¯é™·é˜±"**

**è‡´å‘½åœºæ™¯** (Steps 13-17):
```
LLMçœ‹åˆ°çš„ç»éªŒ:
  ä»çŠ¶æ€Sï¼Œæ‰§è¡ŒåŠ¨ä½œAï¼Œä»ç„¶åœ¨çŠ¶æ€S
  
LLMçš„ç†è§£: 
  "è¿™ä¸ªåŠ¨ä½œåœ¨è¿™ä¸ªçŠ¶æ€ä¸‹æ˜¯å¯è¡Œçš„ï¼Œä¿æŒå¹³è¡¡"
  
å®é™…æƒ…å†µ:
  ç‰©ç†ç³»ç»Ÿåœ¨ç¼“æ…¢å˜åŒ–ï¼Œå³å°†å¤±æ§
  ç¦»æ•£åŒ–éšè—äº†å¾®å°ä½†è‡´å‘½çš„å˜åŒ–
```

**ä¸ºä»€ä¹ˆLLMä¼šé™·å…¥å¾ªç¯ï¼Ÿ**
1. æ£€ç´¢åˆ°4æ¡ç›¸åŒç»éªŒï¼š`(4,1,1,-1) â†’ action 1 â†’ (4,1,1,-1)`
2. Promptæ²¡æœ‰è­¦å‘Š"é‡å¤ç›¸åŒåŠ¨ä½œå¯èƒ½å±é™©"
3. LLMè®¤ä¸º"æ—¢ç„¶ä¹‹å‰æˆåŠŸäº†4æ¬¡ï¼Œå°±ç»§ç»­"
4. ç¬¬5æ¬¡æ‰§è¡Œæ—¶ï¼Œç´¯ç§¯çš„å¾®å°å˜åŒ–å¯¼è‡´poleå€’ä¸‹

---

### 3. **ç¼ºå°‘å¤±è´¥æ ‡è®°å’Œè­¦å‘Š**

**å¤±è´¥ç»éªŒ**:
```json
{
  "st": {"theta_bin": 1},  // poleå‘å·¦å€¾æ–œ
  "action": 1,             // å‘å³æ¨
  "st1": {"theta_bin": 0}  // poleå€’ä¸‹ï¼
}
```

**é—®é¢˜**:
- è¿™æ¡ç»éªŒä¿å­˜äº†ï¼Œä½†æ²¡æœ‰æ ‡è®°ä¸º"å¤±è´¥"
- Promptä¸­æ²¡æœ‰ç‰¹æ®Šè­¦å‘Š
- å¦‚æœå†æ¬¡é‡åˆ° `theta_bin=1` çš„çŠ¶æ€ï¼ŒLLMå¯èƒ½è¿˜ä¼šé€‰æ‹© action 1

---

## ğŸ¤” åäº‹å®åˆ†æï¼šæ²¡æœ‰ç»éªŒä¼šæ›´å¥½å—ï¼Ÿ

### å‡è®¾åœºæ™¯ï¼šä¸ä½¿ç”¨ç»éªŒ

**éšæœºç­–ç•¥å¹³å‡è¡¨ç°**: ~22æ­¥ (CartPoleåŸºå‡†)

**æœ‰ç»éªŒçš„LLMè¡¨ç°**: 18æ­¥

**ç»“è®º**: **ä½¿ç”¨ç»éªŒåè€Œæ¯”éšæœºç­–ç•¥æ›´å·®ï¼**

### ä¸ºä»€ä¹ˆï¼Ÿ

1. **æ— ç»éªŒæ—¶**: LLMæ ¹æ®å½“å‰çŠ¶æ€åšå†³ç­–
   - çœ‹åˆ° `theta_bin=1` (å±é™©å€¾æ–œ)
   - å¯èƒ½ä¼šå°è¯•ä¸åŒåŠ¨ä½œ
   - æœ‰ä¸€å®šæ¦‚ç‡åšå‡ºæ­£ç¡®å†³ç­–

2. **æœ‰ç»éªŒæ—¶**: LLMè¢«è¯¯å¯¼
   - æ£€ç´¢åˆ°4æ¡"æˆåŠŸ"ç»éªŒï¼ˆå®é™…æ˜¯å¾ªç¯ï¼‰
   - åšå®šåœ°é€‰æ‹© action 1
   - é™·å…¥æ­»å¾ªç¯ç›´åˆ°å€’ä¸‹

---

## ğŸ“‰ ç»éªŒç³»ç»Ÿåœ¨CartPoleä¸Šå¤±è´¥çš„æ ¹æœ¬åŸå› 

### 1. **çŠ¶æ€ç©ºé—´ä¸åŒ¹é…**

| ç»´åº¦ | è¿ç»­ç©ºé—´ | ç¦»æ•£bins | ä¿¡æ¯æŸå¤± |
|------|----------|----------|----------|
| x | [-4.8, 4.8] | 7 bins | ä¸¥é‡ |
| theta | [-0.42, 0.42] | 7 bins | **è‡´å‘½** |
| x_dot | [-âˆ, +âˆ] | 3 (sign) | æä¸¥é‡ |
| theta_dot | [-âˆ, +âˆ] | 3 (sign) | æä¸¥é‡ |

**é—®é¢˜**: thetaåœ¨0.2095é™„è¿‘çš„å¾®å°å˜åŒ–ï¼ˆå¦‚0.09â†’0.11ï¼‰å¯èƒ½ä¸æ”¹å˜binï¼Œä½†è¶³ä»¥å¯¼è‡´å€’ä¸‹ã€‚

### 2. **åŠ¨æ€ç³»ç»Ÿçš„æ—¶åºæ€§**

**CartPoleæœ¬è´¨**: äºŒé˜¶åŠ¨æ€ç³»ç»Ÿ
- çŠ¶æ€è½¬ç§»ä¾èµ–äºé€Ÿåº¦å’ŒåŠ é€Ÿåº¦
- "åŸåœ°è¸æ­¥"åœ¨ç¦»æ•£binsä¸­â‰ ç‰©ç†ä¸Šé™æ­¢
- éœ€è¦å¤šæ­¥å‰ç»ï¼Œå•æ­¥ç»éªŒä¸å¤Ÿ

**å¯¹æ¯”FrozenLake**:
- é™æ€ç½‘æ ¼ä¸–ç•Œ
- çŠ¶æ€è½¬ç§»ç¡®å®šï¼ˆå¤§éƒ¨åˆ†æƒ…å†µï¼‰
- å•æ­¥ç»éªŒæœ‰æ„ä¹‰ï¼š"ä»(0,0)å¾€å³èµ°åˆ°(0,1)"

### 3. **Promptå·¥ç¨‹ä¸è¶³**

å½“å‰promptç¼ºå°‘ï¼š
- âŒ "é¿å…é‡å¤ç›¸åŒåŠ¨ä½œ"çš„æ˜ç¡®æŒ‡ä»¤
- âŒ å¯¹"åŸåœ°è¸æ­¥"ç»éªŒçš„è¯†åˆ«å’Œè­¦å‘Š
- âŒ å¯¹è¾¹ç•ŒçŠ¶æ€ï¼ˆtheta_bin=0/1/5/6ï¼‰çš„ç‰¹æ®Šå¤„ç†
- âŒ å¯¹å¤±è´¥ç»éªŒçš„çº¢è‰²æ ‡è®°

---

## âœ… ç»éªŒç³»ç»Ÿåœ¨FrozenLakeä¸Šä¸ºä»€ä¹ˆæœ‰æ•ˆï¼Ÿ

### å¯¹æ¯”åˆ†æ

| ç‰¹æ€§ | FrozenLake | CartPole |
|------|-----------|----------|
| **çŠ¶æ€ç©ºé—´** | ç¦»æ•£ç½‘æ ¼ (4x4) | è¿ç»­ç©ºé—´ â†’ ç¦»æ•£ |
| **çŠ¶æ€è½¬ç§»** | ç¡®å®šæ€§ï¼ˆ90%ï¼‰ | å¤æ‚åŠ¨æ€ç³»ç»Ÿ |
| **ç›®æ ‡** | é¿å¼€holeï¼Œåˆ°è¾¾goal | æŒç»­å¹³è¡¡ |
| **å¤±è´¥æ˜ç¡®** | âœ… holeä½ç½®å›ºå®š | âŒ è¾¹ç•Œæ¨¡ç³Š |
| **ç»éªŒè¯­ä¹‰** | âœ… "è¿™æ¡è·¯æœ‰hole" | âš ï¸ "è¿™ä¸ªåŠ¨ä½œä¿æŒå¹³è¡¡" |
| **å•æ­¥å†³ç­–** | âœ… è¶³å¤Ÿ | âŒ éœ€è¦å¤šæ­¥ |

**ç»“è®º**: FrozenLakeçš„ç¦»æ•£ã€é™æ€ç‰¹æ€§å¤©ç„¶é€‚åˆç»éªŒç³»ç»Ÿï¼Œè€ŒCartPoleçš„è¿ç»­ã€åŠ¨æ€ç‰¹æ€§ä¸é€‚åˆã€‚

---

## ğŸ”§ å¦‚ä½•è®©ç»éªŒå¯¹CartPoleæœ‰ç”¨ï¼Ÿ

### çŸ­æœŸæ”¹è¿›ï¼ˆPromptå·¥ç¨‹ï¼‰

#### 1. æ ‡è®°å¤±è´¥ç»éªŒ
```python
if next_theta_bin in [0, 6]:  # è¾¹ç•Œ
    user_prompt += "âŒ FAILED: Pole fell! AVOID this action!\n"
```

#### 2. è­¦å‘Šå¾ªç¯è¡Œä¸º
```python
if exp['st'] == exp['st1']:
    user_prompt += "âš ï¸ NO PROGRESS: State unchanged, try another action\n"
```

#### 3. å¼ºè°ƒå±é™©çŠ¶æ€
```python
if state['theta_bin'] in [0, 1, 5, 6]:
    user_prompt += "ğŸš¨ CRITICAL: Pole near falling! Be careful!\n"
```

### ä¸­æœŸæ”¹è¿›ï¼ˆç®—æ³•ä¼˜åŒ–ï¼‰

#### 1. æ›´ç»†çš„çŠ¶æ€ç¦»æ•£åŒ–
```python
# å½“å‰: 7 bins for theta
theta_bins = [-0.2095, -0.1, -0.05, 0, 0.05, 0.1, 0.2095]

# æ”¹è¿›: 15 binsï¼ˆæ›´ç»†ç²’åº¦ï¼‰
theta_bins = np.linspace(-0.2095, 0.2095, 15)
```

#### 2. å¤šæ­¥è½¨è¿¹ç»éªŒ
```python
# ä¸ä»…ä¿å­˜ (st, a, st1)
# è¿˜ä¿å­˜ (st, [a1,a2,a3], st3) å’Œæœ€ç»ˆreward
{
    "trajectory": [(st0, a0), (st1, a1), (st2, a2)],
    "final_reward": 15,
    "success": True
}
```

#### 3. ä»·å€¼å‡½æ•°å­¦ä¹ 
```python
# ä¸ºæ¯ä¸ªçŠ¶æ€ä¼°è®¡æœŸæœ›å›æŠ¥
V(state) = average(total_rewards_from_this_state)

# åœ¨promptä¸­æ˜¾ç¤º
user_prompt += f"Expected remaining steps from this state: {V(state):.1f}\n"
```

### é•¿æœŸæ”¹è¿›ï¼ˆæ¶æ„å‡çº§ï¼‰

#### 1. æ··åˆç³»ç»Ÿ
- **LLM**: é«˜å±‚ç­–ç•¥å†³ç­–ï¼ˆ"éœ€è¦å‘å·¦æ ¡æ­£"ï¼‰
- **RL/PID**: ä½å±‚åŠ¨ä½œæ‰§è¡Œï¼ˆç²¾ç¡®åŠ›åº¦æ§åˆ¶ï¼‰

#### 2. åœ¨çº¿å­¦ä¹ 
- ä¸æ˜¯å•æ¬¡exploration
- å¤šæ¬¡è¯•éªŒï¼ŒæŒç»­ä¼˜åŒ–ç»éªŒåº“
- åˆ é™¤è¯¯å¯¼æ€§ç»éªŒï¼Œä¿ç•™é«˜ä»·å€¼ç»éªŒ

#### 3. åˆ†å±‚ç»éªŒåº“
```python
experience_db = {
    "safe_states": [...],      # V(s) > 10
    "dangerous_states": [...],  # V(s) < 5
    "failure_states": [...],    # å¯¼è‡´å€’ä¸‹
}
```

---

## ğŸ“Š å®šé‡å¯¹æ¯”ï¼šæœ‰/æ— ç»éªŒ

| æŒ‡æ ‡ | æ— ç»éªŒï¼ˆé¢„æµ‹ï¼‰ | æœ‰ç»éªŒï¼ˆå®æµ‹ï¼‰ | å·®å¼‚ |
|------|---------------|---------------|------|
| å¹³å‡æ­¥æ•° | ~22 | 18 | -18% |
| å¾ªç¯æ¬¡æ•° | ~1 | 3+ | +200% |
| å¤±è´¥é€Ÿåº¦ | æ¸è¿› | çªç„¶ | - |
| å†³ç­–å¤šæ ·æ€§ | é«˜ | ä½ | - |

---

## ğŸ“ å…³é”®å¯ç¤º

### 1. **ç»éªŒâ‰ æ™ºèƒ½**
- ç»éªŒåªæœ‰åœ¨**æ­£ç¡®æ ‡è®°**å’Œ**æ°å½“ä½¿ç”¨**æ—¶æ‰æœ‰ä»·å€¼
- è¯¯å¯¼æ€§ç»éªŒæ¯”æ— ç»éªŒæ›´å±é™©

### 2. **ç¦»æ•£åŒ–çš„ä»£ä»·**
- å°†è¿ç»­ç©ºé—´ç¦»æ•£åŒ–å¿…ç„¶æŸå¤±ä¿¡æ¯
- å¯¹äºåŠ¨æ€ç³»ç»Ÿï¼Œä¿¡æ¯æŸå¤±å¯èƒ½æ˜¯è‡´å‘½çš„

### 3. **Promptå·¥ç¨‹çš„é‡è¦æ€§**
- å³ä½¿æœ‰å¥½çš„ç»éªŒï¼Œä¹Ÿéœ€è¦å¥½çš„promptæ¥å¼•å¯¼LLMæ­£ç¡®ä½¿ç”¨
- "å¾ªç¯æ£€æµ‹"ã€"å¤±è´¥è­¦å‘Š"ç­‰å…ƒè®¤çŸ¥èƒ½åŠ›éœ€è¦æ˜¾å¼ç¼–ç 

### 4. **ä»»åŠ¡é€‚é…æ€§**
- ç»éªŒå­¦ä¹ ç³»ç»Ÿä¸æ˜¯ä¸‡èƒ½çš„
- FrozenLake: âœ… å®Œç¾åŒ¹é…
- Webshop: âœ… è¾ƒå¥½åŒ¹é…ï¼ˆURLæ ‡å‡†åŒ–åï¼‰
- CartPole: âŒ ä¸åŒ¹é…ï¼ˆéœ€è¦æ·±åº¦æ”¹è¿›ï¼‰

---

## ğŸ’¡ æœ€ç»ˆç»“è®º

### å¯¹äºå½“å‰CartPoleå®ç°ï¼š

**ç»éªŒç³»ç»Ÿçš„æ•ˆç”¨**: **è´Ÿé¢ (-18%æ€§èƒ½)**

**åŸå› **:
1. 60%çš„ç»éªŒæ˜¯è¯¯å¯¼æ€§çš„"åŸåœ°è¸æ­¥"
2. LLMæ— æ³•è¯†åˆ«å¾ªç¯é™·é˜±
3. Promptç¼ºå°‘å¿…è¦çš„å…ƒè®¤çŸ¥æŒ‡å¯¼

**å»ºè®®**:
- ğŸ”§ **ç«‹å³**: ä¼˜åŒ–promptï¼Œæ·»åŠ å¾ªç¯æ£€æµ‹å’Œå¤±è´¥è­¦å‘Š
- ğŸ“Š **æœ¬å‘¨**: ç»†åŒ–çŠ¶æ€ç¦»æ•£åŒ–ï¼Œæé«˜binsæ•°é‡
- ğŸ§  **é•¿æœŸ**: è€ƒè™‘å¤šæ­¥è½¨è¿¹ã€ä»·å€¼å‡½æ•°ã€æ··åˆç³»ç»Ÿ

### å¯¹äºç»éªŒç³»ç»Ÿæœ¬èº«ï¼š

**ä¸åº”æ”¾å¼ƒç»éªŒç³»ç»Ÿ**ï¼Œè€Œåº”ï¼š
1. âœ… è®¤è¯†åˆ°ä¸åŒä»»åŠ¡çš„é€‚ç”¨æ€§å·®å¼‚
2. âœ… é’ˆå¯¹åŠ¨æ€ç³»ç»Ÿåšä¸“é—¨ä¼˜åŒ–
3. âœ… æ”¹è¿›ç»éªŒè´¨é‡è¯„ä¼°å’Œç­›é€‰æœºåˆ¶

---

**ç”Ÿæˆæ—¶é—´**: 2025-11-26  
**åˆ†æå¯¹è±¡**: CartPoleæµ‹è¯•ç»“æœ  
**æ ¸å¿ƒå‘ç°**: å½“å‰ç»éªŒç³»ç»Ÿåœ¨CartPoleä¸Šèµ·åä½œç”¨ï¼Œéœ€è¦æ·±åº¦æ”¹è¿›

